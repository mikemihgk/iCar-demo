function updateService() {
  let currentKm = parseInt(document.getElementById('currentKm').value) || 0;
  let lastDateStr = document.getElementById('lastServiceDate') ? document.getElementById('lastServiceDate').value : '2025-01-01'; // Προαιρετικό input
  let lastDate = new Date(lastDateStr);
  let monthlyKm = 1000; // Default km/μήνα – βάλε input αργότερα
  let items = document.querySelectorAll('#serviceList li');

  // Αποθήκευση δεδομένων τοπικά
  localStorage.setItem('carData', JSON.stringify({currentKm: currentKm, lastDate: lastDateStr}));

  items.forEach(item => {
    let task = item.getAttribute('data-task');
    let intervalKm = parseInt(item.getAttribute('data-km')) || 0;
    let intervalMonths = parseInt(item.getAttribute('data-months')) || 0;

    // ΣΩΣΤΟΣ ΥΠΟΛΟΓΙΣΜΟΣ KM: Επόμενο πολλαπλάσιο interval
    let nextKm;
    if (intervalKm > 0) {
      nextKm = Math.ceil(currentKm / intervalKm) * intervalKm;
      if (nextKm <= currentKm) nextKm += intervalKm; // Αν ακριβώς στο interval, πήγαινε στο επόμενο
    } else {
      nextKm = 'N/A';
    }

    // ΣΩΣΤΟΣ ΥΠΟΛΟΓΙΣΜΟΣ ΗΜΕΡΟΜΗΝΙΑΣ: Βάσει months + km-based estimate
    let nextDateTime = new Date(lastDate);
    nextDateTime.setMonth(nextDateTime.getMonth() + intervalMonths);

    // Km-based ημερομηνία (αν monthlyKm δοθεί)
    let kmDays = intervalKm > 0 ? Math.round((nextKm - currentKm) / monthlyKm * 30) : 0;
    let nextDateKm = new Date();
    nextDateKm.setDate(nextDateKm.getDate() + kmDays);

    // Χρησιμοποίησε το νωρίτερο (km ή time-based)
    let nextDate = nextDateTime < nextDateKm ? nextDateTime : nextDateKm;

    // Εμφάνιση
    let daysToNext = Math.max(0, Math.ceil((nextDate - new Date()) / (1000 * 60 * 60 * 24)));
    item.innerHTML = `${task} - Επόμενο: ${nextKm} km ή ${nextDate.toLocaleDateString('el-GR')} (σε ${daysToNext} μέρες)`;

    // Βασική Ειδοποίηση (αν <20 μέρες)
    if (daysToNext < 20 && daysToNext > 0) {
      alert(`${task}: Σε ${daysToNext} μέρες! Κλείσε ραντεβού service.`);
    }
  });
}

// Φόρτωση αποθηκευμένων δεδομένων στην αρχή
window.onload = function() {
  let saved = localStorage.getItem('carData');
  if (saved) {
    let data = JSON.parse(saved);
    document.getElementById('currentKm').value = data.currentKm || 10000;
    // Αν έχεις input για lastDate, βάλε data.lastDate
  }
  updateService(); // Αυτόματο update στην αρχή
};