<!DOCTYPE html>
<html lang="el">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>iCar</title>
<style>
  body { font-family: Arial, sans-serif; background-color: #f4f4f4; margin:0; padding:20px; text-align:center; }
  .container { background-color:#fff; border-radius:10px; padding:20px; max-width:500px; margin:0 auto; box-shadow:0 0 10px rgba(0,0,0,0.1); text-align:left; }
  h1,h2,h3 { text-align:center; }
  input,select,button { width:100%; padding:10px; margin:5px 0; border-radius:5px; border:1px solid #ddd; box-sizing:border-box; }
  button { cursor:pointer; background-color:#007bff; color:white; border:none; }
  button:hover { background-color:#0056b3; }
  ul { list-style:none; padding:0; }
  li { padding:5px; border-bottom:1px solid #ddd; display:flex; justify-content:space-between; align-items:center; }
  .category { font-weight:bold; background:#eee; padding:5px; margin-top:10px; border-radius:5px; width:100%; display:block; }
  .date { font-size:0.8em; color:#555; margin-left:10px; }
  .signature { text-align:center; margin-top:20px; color:#888; font-size:0.8em; }
</style>
</head>
<body>
<div class="container">
  <h1>iCar</h1>

  <h3>Επιλογή Οχήματος</h3>
  <label>Μάρκα:</label>
  <select id="brand" onchange="updateModels(); updateVehicle();">
    <option value="Audi">Audi</option>
    <option value="Smart">Smart</option>
  </select>

  <label>Μοντέλο:</label>
  <select id="model" onchange="updateVehicle();"></select>

  <label>Χρονολογία:</label>
  <input type="number" id="year" value="2021" min="2000" max="2030" onchange="updateVehicle();">

  <label>Μηχανή:</label>
  <input type="text" id="engine" value="1.0 TFSI" onchange="updateVehicle();">

  <button onclick="showVehicleHistory()">Ιστορικό Οχήματος</button>

  <h3>Λίστα Ελέγχων</h3>
  <ul id="serviceList"></ul>

  <p class="signature">Developed by Mike</p>
</div>

<script>
// Drop-down μοντέλα
const modelsByBrand = {
  'Audi':['Q2','SQ2'],
  'Smart':['Fortwo 600cc 2000']
};

// Όλα τα σημεία ελέγχου με κατηγορίες
const allChecks = [
  {category:"Service", task:"Λάδια κινητήρα"},
  {category:"Service", task:"Φίλτρο αέρα"},
  {category:"Service", task:"Φίλτρο καμπίνας"},
  {category:"Service", task:"Μπουζί"},
  {category:"Μηχανικά", task:"Υαλοκαθαριστήρες"},
  {category:"Μηχανικά", task:"Φρένα"},
  {category:"Μηχανικά", task:"Αμορτισέρ"},
  {category:"Ελαστικά", task:"Έλεγχος πίεσης ελαστικών"},
  {category:"Ελαστικά", task:"Αλλαγή ελαστικών"},
  {category:"Αμάξωμα", task:"Έλεγχος φώτων"},
  {category:"Αμάξωμα", task:"Έλεγχος υαλοκαθαριστήρων"},
  {category:"Έλεγχοι Ασφαλείας", task:"Ασφάλεια"},
  {category:"Έλεγχοι Ασφαλείας", task:"ΚΤΕΟ"},
  {category:"Υγρά", task:"Λάδια φρένων"},
  {category:"Υγρά", task:"Ψυκτικό"},
];

// Γέμισμα drop-down μοντέλων
function updateModels(){
  const brand=document.getElementById('brand').value;
  const modelSelect=document.getElementById('model');
  modelSelect.innerHTML='';
  const models=modelsByBrand[brand]||[];
  models.forEach(m=>{
    const option=document.createElement('option');
    option.value=m; option.textContent=m;
    modelSelect.appendChild(option);
  });
  if(models.length>0) modelSelect.value=models[0];
}

// Ενημέρωση λίστας οχήματος
function updateVehicle(){
  const brand=document.getElementById('brand').value;
  const model=document.getElementById('model').value;
  const year=document.getElementById('year').value;
  const engine=document.getElementById('engine').value;
  const fullModel=brand+' '+model;

  const serviceList=document.getElementById('serviceList');
  serviceList.innerHTML='';

  let currentCategory='';
  allChecks.forEach(c=>{
    if(c.category!==currentCategory){
      currentCategory=c.category;
      const liCat=document.createElement('li');
      liCat.textContent=currentCategory;
      liCat.className='category';
      serviceList.appendChild(liCat);
    }
    const li=document.createElement('li');
    li.innerHTML=`<span>${c.task}</span> <input type="checkbox" onchange="markDone(this)" id="${fullModel}_${c.task.replace(/ /g,'_')}"> <span class="date" id="date_${fullModel}_${c.task.replace(/ /g,'_')}"></span>`;
    serviceList.appendChild(li);
  });

  // Επαναφορά από localStorage αν υπάρχει
  const saved=localStorage.getItem(fullModel);
  if(saved){
    const data=JSON.parse(saved);
    Object.keys(data).forEach(k=>{
      const cb=document.getElementById(fullModel+'_'+k.replace(/ /g,'_'));
      const dt=document.getElementById('date_'+fullModel+'_'+k.replace(/ /g,'_'));
      if(cb && dt){
        cb.checked=data[k].done;
        dt.textContent=data[k].date||'';
      }
    });
  }
}

// Σήμανση ολοκληρωμένου και αποθήκευση
function markDone(checkbox){
  const dateSpan=document.getElementById('date_'+checkbox.id);
  if(checkbox.checked){
    const today=new Date();
    const dd=String(today.getDate()).padStart(2,'0');
    const mm=String(today.getMonth()+1).padStart(2,'0');
    const yyyy=today.getFullYear();
    dateSpan.textContent=`Έγινε: ${dd}/${mm}/${yyyy}`;
  }else{
    dateSpan.textContent='';
  }

  const brand=document.getElementById('brand').value;
  const model=document.getElementById('model').value;
  const fullModel=brand+' '+model;

  const checkboxes=document.querySelectorAll('#serviceList input[type=checkbox]');
  const saveData={};
  checkboxes.forEach(cb=>{
    const dt=document.getElementById('date_'+cb.id);
    const taskName=cb.id.split('_').slice(1).join(' ').replace(/_/g,' ');
    saveData[taskName]={done:cb.checked, date:dt.textContent};
  });
  localStorage.setItem(fullModel, JSON.stringify(saveData));
}

// Εμφάνιση ιστορικού οχήματος
function showVehicleHistory(){
  const brand=document.getElementById('brand').value;
  const model=document.getElementById('model').value;
  const fullModel=brand+' '+model;
  const saved=localStorage.getItem(fullModel);
  if(saved){
    const data=JSON.parse(saved);
    let msg='Ιστορικό '+fullModel+':\n';
    Object.keys(data).forEach(k=>{
      msg+=`${k}: ${data[k].done?'✅':'❌'} ${data[k].date||''}\n`;
    });
    alert(msg);
  }else{
    alert('Δεν υπάρχει ιστορικό για '+fullModel);
  }
}

window.onload=function(){ updateModels(); updateVehicle(); };
</script>
</body>
</html>